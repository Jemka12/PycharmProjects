
import scanner

target_url = "http://10.0.2.14/dvwa/"
link_to_ignore = ["http://10.0.2.14/dvwa/login.php"]

data_dict = {"username": "admin", "password": "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target_url, link_to_ignore)
vuln_scanner.session.post("http://10.0.2.14/dvwa/login.php", data=data_dict)


vuln_scanner.crawl()
forms = vuln_scanner.extract_forms("http://10.0.2.14/dvwa/vulnerabilities/xss_r/")


print(forms)
respone = vuln_scanner.test_xss_in_form(forms[0], "http://10.0.2.14/dvwa/vulnerabilities/xss_r/")
print(respone)

respone = vuln_scanner.test_xss_in_link("http://10.0.2.14/dvwa/vulnerabilities/xss_r/?name=#")
print(respone)

vuln_scanner.run_scanner()